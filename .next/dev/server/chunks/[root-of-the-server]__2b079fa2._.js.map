{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/adrianbautista/Desktop/social-monetization-platform%201.20.22%E2%80%AFa.m./lib/db.ts"],"sourcesContent":["import { PrismaClient } from '@prisma/client'\n\nconst globalForPrisma = globalThis as unknown as {\n  prisma: PrismaClient | undefined\n}\n\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient()\n\nif (process.env.NODE_ENV !== 'production') globalForPrisma.prisma = prisma"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI,IAAI,6IAAY;AAEhE,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 65, "column": 0}, "map": {"version":3,"sources":["file:///Users/adrianbautista/Desktop/social-monetization-platform%201.20.22%E2%80%AFa.m./app/api/stats/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\n// CAMBIO IMPORTANTE: Usamos la ruta relativa para asegurar que encuentre la DB\nimport { prisma } from \"../../../lib/db\";\n\nexport async function POST(req: Request) {\n  try {\n    const body = await req.json();\n    const { email } = body;\n\n    if (!email) {\n      return NextResponse.json({ error: \"Email requerido\" }, { status: 400 });\n    }\n\n    const user = await prisma.user.findUnique({\n      where: { email },\n      include: {\n        _count: {\n          select: {\n            posts: true,\n            followedBy: true,\n          }\n        },\n        posts: {\n            include: {\n                _count: {\n                    select: { likes: true }\n                }\n            }\n        }\n      }\n    });\n\n    if (!user) {\n      return NextResponse.json({ error: \"Usuario no encontrado\" }, { status: 404 });\n    }\n\n    // Calculamos el total de likes\n    const totalLikes = user.posts.reduce((acc, post) => acc + post._count.likes, 0);\n\n    return NextResponse.json({\n      postsCount: user._count.posts,\n      fansCount: user._count.followedBy,\n      likesCount: totalLikes\n    });\n\n  } catch (error) {\n    console.error(\"Error API Stats:\", error);\n    return NextResponse.json({ error: \"Error interno\" }, { status: 500 });\n  }\n}"],"names":[],"mappings":";;;;AAAA;AACA,+EAA+E;AAC/E;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,KAAK,EAAE,GAAG;QAElB,IAAI,CAAC,OAAO;YACV,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAkB,GAAG;gBAAE,QAAQ;YAAI;QACvE;QAEA,MAAM,OAAO,MAAM,qHAAM,CAAC,IAAI,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE;YAAM;YACf,SAAS;gBACP,QAAQ;oBACN,QAAQ;wBACN,OAAO;wBACP,YAAY;oBACd;gBACF;gBACA,OAAO;oBACH,SAAS;wBACL,QAAQ;4BACJ,QAAQ;gCAAE,OAAO;4BAAK;wBAC1B;oBACJ;gBACJ;YACF;QACF;QAEA,IAAI,CAAC,MAAM;YACT,OAAO,+QAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAwB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,+BAA+B;QAC/B,MAAM,aAAa,KAAK,KAAK,CAAC,MAAM,CAAC,CAAC,KAAK,OAAS,MAAM,KAAK,MAAM,CAAC,KAAK,EAAE;QAE7E,OAAO,+QAAY,CAAC,IAAI,CAAC;YACvB,YAAY,KAAK,MAAM,CAAC,KAAK;YAC7B,WAAW,KAAK,MAAM,CAAC,UAAU;YACjC,YAAY;QACd;IAEF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,+QAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAgB,GAAG;YAAE,QAAQ;QAAI;IACrE;AACF"}}]
}